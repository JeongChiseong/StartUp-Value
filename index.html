<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>스타트업 밸류에이션 계산기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .input-box {
            @apply border-2 border-gray-200 rounded-xl p-4 bg-white shadow-sm transition-all duration-200 hover:border-blue-300 focus-within:border-blue-500 focus-within:ring-4 focus-within:ring-blue-100;
        }
        .result-card {
            @apply bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl p-6 shadow-lg;
        }
        .metric-box {
            @apply bg-white bg-opacity-20 rounded-lg p-4 backdrop-blur-sm;
        }
        body {
            font-weight: 600;
        }
        input, select {
            font-weight: 500;
        }
    </style>
</head>
<body class="bg-gray-500 min-h-screen">
    <!-- 헤더 -->
    <div class="bg-white shadow-sm border-b">
        <div class="max-w-4xl mx-auto px-6 py-6">
            <h1 class="text-3xl font-bold text-gray-800 text-center">🧮 스타트업 밸류에이션 계산기</h1>
            <p class="text-gray-600 text-center mt-2">간단한 입력으로 정확한 기업가치 산정</p>
        </div>
    </div>

    <div class="max-w-4xl mx-auto px-6 py-8">
        <div class="grid md:grid-cols-2 gap-8">
            <!-- 입력 섹션 -->
            <div class="space-y-6">
                <!-- 기본 정보 -->
                <div class="input-box">
                    <h2 class="text-lg font-semibold mb-4 text-gray-800">📋 기본 정보</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">회사명</label>
                            <input type="text" id="companyName" value="사이러스바이크" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">업종</label>
                            <select id="industry" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="HaaS">HaaS (하드웨어 서비스)</option>
                                <option value="SaaS">SaaS (소프트웨어)</option>
                                <option value="E-commerce">E-commerce</option>
                                <option value="핀테크">핀테크</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- 매출 정보 -->
                <div class="input-box">
                    <h2 class="text-lg font-semibold mb-4 text-gray-800">💰 매출 정보 (올해 실적, 만원)</h2>
                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">하드웨어 매출</label>
                                <input type="text" id="hardwareSales" placeholder="3,630" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                                       oninput="formatNumber(this); calculate()">
                                <span class="text-xs text-gray-500">장비 판매/보증금</span>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">구독 매출</label>
                                <input type="text" id="subscriptionSales" placeholder="37,926" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                                       oninput="formatNumber(this); calculate()">
                                <span class="text-xs text-gray-500">월 구독료 × 12개월</span>
                            </div>
                        </div>
                        <div class="bg-blue-50 p-3 rounded-lg">
                            <span class="text-sm font-medium">총 연매출: </span>
                            <span id="totalRevenue" class="text-lg font-bold text-blue-600">0만원</span>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">전년도 매출</label>
                                <input type="text" id="previousRevenue" placeholder="25,000" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                                       oninput="formatNumber(this); calculate()">
                                <span class="text-xs text-gray-500">작년 동기 총매출</span>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">순이익</label>
                                <input type="text" id="netIncome" placeholder="15,000" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                                       oninput="formatNumber(this); calculate()">
                                <span class="text-xs text-gray-500">올해 순이익</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 투자 정보 -->
                <div class="input-box">
                    <h2 class="text-lg font-semibold mb-4 text-gray-800">🎯 투자 정보</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">투자 유치 목표</label>
                            <input type="text" id="investment" value="40,000" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                                   oninput="formatNumber(this); calculate()">
                            <span class="text-xs text-gray-500">단위: 만원 (예: 40,000 = 4억원)</span>
                        </div>
                    </div>
                </div>

                <!-- 고객 지표 -->
                <div class="input-box">
                    <h2 class="text-lg font-semibold mb-4 text-gray-800">👥 고객 지표</h2>
                    <div class="space-y-4">
                        <div class="grid grid-cols-3 gap-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">전년도 고객수</label>
                                <input type="text" id="previousCustomers" placeholder="30" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                                       oninput="formatNumber(this); calculate()">
                                <span class="text-xs text-gray-500">작년 말 기준</span>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">올해 신규 고객</label>
                                <input type="text" id="newCustomers" placeholder="20" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                                       oninput="formatNumber(this); calculate()">
                                <span class="text-xs text-gray-500">올해 추가</span>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">현재 총 고객수</label>
                                <input type="text" id="totalCustomers" placeholder="50" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                                       oninput="formatNumber(this); calculate()">
                                <span class="text-xs text-gray-500">현재 계약 중</span>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">전용 앱 MAU (월활성유저)</label>
                            <input type="text" id="mau" placeholder="500" 
                                   class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                                   oninput="formatNumber(this); calculate()">
                            <span class="text-xs text-gray-500">월평균 앱 사용자 수 (명)</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 결과 섹션 -->
            <div class="space-y-6">
                <!-- 메인 결과 -->
                <div class="result-card">
                    <h2 class="text-xl font-bold mb-6 text-center">📊 밸류에이션 결과</h2>
                    <div class="space-y-4">
                        <div class="metric-box">
                            <div class="text-sm opacity-90">기업가치 (Pre-money)</div>
                            <div class="text-2xl font-bold"><span id="valuation">0</span>억원</div>
                        </div>
                        <div class="metric-box">
                            <div class="text-sm opacity-90">투자 후 가치</div>
                            <div class="text-2xl font-bold"><span id="postMoney">0</span>억원</div>
                        </div>
                        <div class="metric-box">
                            <div class="text-sm opacity-90">취득 지분율</div>
                            <div class="text-2xl font-bold"><span id="equity">0</span>%</div>
                        </div>
                    </div>
                </div>

                <!-- 상세 분석 -->
                <div class="bg-white rounded-xl p-6 shadow-sm border">
                    <h3 class="text-lg font-semibold mb-4">📈 상세 분석</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-600">매출 성장률</span>
                            <span id="growthRate" class="font-semibold">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">고객 성장률</span>
                            <span id="customerGrowthRate" class="font-semibold">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">구독 매출 비중</span>
                            <span id="subscriptionRatio" class="font-semibold">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">PSR 배수</span>
                            <span id="psrMultiple" class="font-semibold">0배</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">고객당 연매출</span>
                            <span id="revenuePerCustomer" class="font-semibold">0만원</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">주당 가치</span>
                            <span id="sharePrice" class="font-semibold">0원</span>
                        </div>
                    </div>
                </div>

                <!-- 투자 조건 -->
                <div class="bg-green-50 rounded-xl p-6 border border-green-200">
                    <h3 class="text-lg font-semibold mb-4 text-green-800">💼 투자 조건</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-green-700">투자금액</span>
                            <span id="investAmount" class="font-semibold text-green-800">4억원</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-green-700">취득지분</span>
                            <span id="finalEquity" class="font-semibold text-green-800">0%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-green-700">전환가격</span>
                            <span id="conversionPrice" class="font-semibold text-green-800">0원</span>
                        </div>
                    </div>
                </div>

                <!-- 다운로드 버튼 -->
                <button onclick="downloadReport()" 
                        class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-4 px-6 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl">
                    📥 결과 리포트 다운로드
                </button>
            </div>
        </div>
    </div>

    <script>
        function formatNumber(input) {
            let value = input.value.replace(/,/g, '');
            if (!isNaN(value) && value !== '') {
                input.value = parseInt(value).toLocaleString();
            }
        }

        function getValue(id) { 
            const value = document.getElementById(id).value.replace(/,/g, '');
            return parseFloat(value) || 0; 
        }
        function setText(id, value) { document.getElementById(id).textContent = value; }
        function format(num) { return (num / 10000).toFixed(1); }

        function calculate() {
            const hardware = getValue('hardwareSales');
            const subscription = getValue('subscriptionSales');
            const previous = getValue('previousRevenue');
            const netIncome = getValue('netIncome');
            const investment = getValue('investment');
            
            // 고객 지표
            const previousCustomers = getValue('previousCustomers');
            const newCustomers = getValue('newCustomers');
            const totalCustomers = getValue('totalCustomers');
            const mau = getValue('mau');
            
            const total = hardware + subscription;
            const growth = previous ? ((total - previous) / previous * 100) : 0;
            const subRatio = total ? (subscription / total * 100) : 0;
            
            // 고객 성장률 계산
            const customerGrowth = previousCustomers ? ((totalCustomers - previousCustomers) / previousCustomers * 100) : 0;
            
            // 고객당 연매출 계산
            const revenuePerCustomer = totalCustomers ? (total / totalCustomers) : 0;
            
            // PSR 배수 계산 (고객 지표 반영)
            let multiplier = 5;
            
            // 구독 매출 비중에 따른 배수 조정
            if (subRatio > 70) multiplier += 3;
            else if (subRatio > 50) multiplier += 2;
            
            // 매출 성장률에 따른 배수 조정
            if (growth > 50) multiplier += 2;
            else if (growth > 30) multiplier += 1;
            
            // 고객 성장률에 따른 배수 조정 (새로 추가)
            if (customerGrowth > 100) multiplier += 2; // 고객 2배 이상 증가
            else if (customerGrowth > 50) multiplier += 1; // 고객 50% 이상 증가
            
            // 고객당 매출이 높으면 배수 증가 (고객 단가가 높은 B2B 모델)
            if (revenuePerCustomer > 1000) multiplier += 1; // 고객당 연 1000만원 이상
            else if (revenuePerCustomer > 500) multiplier += 0.5; // 고객당 연 500만원 이상
            
            // MAU 대비 고객 비율 (앱 활성도)
            const appEngagement = totalCustomers && mau ? (mau / totalCustomers) : 0;
            if (appEngagement > 5) multiplier += 1; // MAU가 고객 수의 5배 이상 (높은 활성도)
            else if (appEngagement > 2) multiplier += 0.5; // MAU가 고객 수의 2배 이상
            
            multiplier = Math.max(multiplier, 3);
            
            const valuation = total * multiplier;
            const postMoney = valuation + investment;
            const equity = (investment / postMoney * 100);
            
            // 결과 표시 (천원 단위 콤마 포함)
            setText('totalRevenue', total.toLocaleString() + '만원');
            setText('valuation', format(valuation));
            setText('postMoney', format(postMoney));
            setText('equity', equity.toFixed(1));
            setText('growthRate', growth.toFixed(1) + '%');
            setText('customerGrowthRate', customerGrowth.toFixed(1) + '%');
            setText('subscriptionRatio', subRatio.toFixed(1) + '%');
            setText('psrMultiple', multiplier.toFixed(1) + '배');
            setText('revenuePerCustomer', revenuePerCustomer.toFixed(0) + '만원');
            setText('sharePrice', (valuation / 4).toFixed(0) + '원');
            setText('investAmount', format(investment) + '억원');
            setText('finalEquity', equity.toFixed(1) + '%');
            setText('conversionPrice', (investment * 10000 / (equity * 4)).toFixed(0) + '원');
        }

        function downloadReport() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // 모바일 친화적 사이즈 (세로형)
            canvas.width = 600; 
            canvas.height = 1000;
            
            // 배경 그라디언트
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#667eea'); 
            gradient.addColorStop(1, '#764ba2');
            ctx.fillStyle = gradient; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // 제목 섹션
            const company = document.getElementById('companyName').value || '스타트업';
            ctx.fillStyle = 'white'; 
            ctx.font = 'bold 28px Arial'; 
            ctx.textAlign = 'center';
            ctx.fillText(`${company}`, canvas.width/2, 50);
            ctx.font = 'bold 20px Arial';
            ctx.fillText('밸류에이션 분석 결과', canvas.width/2, 80);
            
            // 날짜
            ctx.font = '14px Arial'; 
            ctx.fillStyle = 'rgba(255,255,255,0.8)';
            ctx.fillText(`분석일: ${new Date().toLocaleDateString('ko-KR')}`, canvas.width/2, 105);
            
            // === 핵심 결과 (두괄식) ===
            ctx.fillStyle = 'rgba(255,255,255,0.1)';
            ctx.fillRect(20, 130, canvas.width-40, 180);
            
            ctx.fillStyle = 'white';
            ctx.font = 'bold 18px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('💰 핵심 결과', canvas.width/2, 155);
            
            const coreResults = [
                ['기업가치', document.getElementById('valuation').textContent + '억원'],
                ['투자 후 가치', document.getElementById('postMoney').textContent + '억원'],
                ['취득 지분율', document.getElementById('equity').textContent + '%'],
                ['PSR 배수', document.getElementById('psrMultiple').textContent]
            ];
            
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'left';
            coreResults.forEach(([label, value], index) => {
                const y = 185 + index * 30;
                ctx.fillStyle = 'rgba(255,255,255,0.9)';
                ctx.fillText(label, 40, y);
                ctx.fillStyle = 'white';
                ctx.font = 'bold 18px Arial';
                ctx.fillText(value, 300, y);
                ctx.font = 'bold 16px Arial';
            });
            
            // === 입력 데이터 정보 ===
            let currentY = 340;
            
            // 매출 정보
            ctx.fillStyle = 'rgba(255,255,255,0.1)';
            ctx.fillRect(20, currentY, canvas.width-40, 120);
            ctx.fillStyle = 'white';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('📊 매출 정보', canvas.width/2, currentY + 25);
            
            const revenueData = [
                ['하드웨어 매출', getValue('hardwareSales').toLocaleString() + '만원'],
                ['구독 매출', getValue('subscriptionSales').toLocaleString() + '만원'],
                ['전년도 매출', getValue('previousRevenue').toLocaleString() + '만원']
            ];
            
            ctx.font = '14px Arial';
            ctx.textAlign = 'left';
            revenueData.forEach(([label, value], index) => {
                const y = currentY + 50 + index * 22;
                ctx.fillStyle = 'rgba(255,255,255,0.8)';
                ctx.fillText(label, 40, y);
                ctx.fillStyle = 'white';
                ctx.fillText(value, 300, y);
            });
            
            currentY += 140;
            
            // 고객 지표
            ctx.fillStyle = 'rgba(255,255,255,0.1)';
            ctx.fillRect(20, currentY, canvas.width-40, 140);
            ctx.fillStyle = 'white';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('👥 고객 지표', canvas.width/2, currentY + 25);
            
            const customerData = [
                ['전년도 고객수', getValue('previousCustomers').toLocaleString() + '명'],
                ['올해 신규 고객', getValue('newCustomers').toLocaleString() + '명'],
                ['현재 총 고객수', getValue('totalCustomers').toLocaleString() + '명'],
                ['월활성유저(MAU)', getValue('mau').toLocaleString() + '명']
            ];
            
            ctx.font = '14px Arial';
            ctx.textAlign = 'left';
            customerData.forEach(([label, value], index) => {
                const y = currentY + 50 + index * 22;
                ctx.fillStyle = 'rgba(255,255,255,0.8)';
                ctx.fillText(label, 40, y);
                ctx.fillStyle = 'white';
                ctx.fillText(value, 300, y);
            });
            
            currentY += 160;
            
            // 성장률 분석
            ctx.fillStyle = 'rgba(255,255,255,0.1)';
            ctx.fillRect(20, currentY, canvas.width-40, 120);
            ctx.fillStyle = 'white';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('📈 성장률 분석', canvas.width/2, currentY + 25);
            
            const growthData = [
                ['매출 성장률', document.getElementById('growthRate').textContent],
                ['고객 성장률', document.getElementById('customerGrowthRate').textContent],
                ['고객당 연매출', document.getElementById('revenuePerCustomer').textContent]
            ];
            
            ctx.font = '14px Arial';
            ctx.textAlign = 'left';
            growthData.forEach(([label, value], index) => {
                const y = currentY + 50 + index * 22;
                ctx.fillStyle = 'rgba(255,255,255,0.8)';
                ctx.fillText(label, 40, y);
                ctx.fillStyle = 'white';
                ctx.fillText(value, 300, y);
            });
            
            currentY += 140;
            
            // 투자 조건
            ctx.fillStyle = 'rgba(255,255,255,0.1)';
            ctx.fillRect(20, currentY, canvas.width-40, 100);
            ctx.fillStyle = 'white';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('💼 투자 조건', canvas.width/2, currentY + 25);
            
            const investmentData = [
                ['투자금액', document.getElementById('investAmount').textContent],
                ['전환가격', document.getElementById('conversionPrice').textContent]
            ];
            
            ctx.font = '14px Arial';
            ctx.textAlign = 'left';
            investmentData.forEach(([label, value], index) => {
                const y = currentY + 50 + index * 22;
                ctx.fillStyle = 'rgba(255,255,255,0.8)';
                ctx.fillText(label, 40, y);
                ctx.fillStyle = 'white';
                ctx.fillText(value, 300, y);
            });
            
            // 워터마크
            ctx.fillStyle = 'rgba(255,255,255,0.5)';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Startup Valuation Calculator', canvas.width/2, canvas.height - 20);
            
            // 다운로드
            canvas.toBlob(blob => {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url; 
                a.download = `${company}_밸류에이션_${new Date().toISOString().slice(0,10)}.png`;
                a.click(); 
                URL.revokeObjectURL(url);
            });
        }

        // 초기 계산
        calculate();
    </script>
</body>
</html>
